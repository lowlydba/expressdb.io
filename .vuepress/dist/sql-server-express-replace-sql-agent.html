<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>SQL Express = No Agent | Express DB</title>
    <meta name="generator" content="VuePress 1.9.10">
    <link rel="icon" href="/favicon.png">
    <meta name="description" content="">
    <meta property="og:locale" content="en_US">
    <meta property="og:type" content="website">
    <meta property="og:site_name" content="Express DB">
    <meta property="og:title" content="Express DB">
    <meta property="og:description" content="Guides and references for SQL Server Express">
    <meta property="og:image" content="/expressdb-og.png">
    <meta property="twitter:card" content="summary">
    <meta property="twitter:domain" content="expressdb.io">
    <meta property="twitter:url" content="https://expressdb.io">
    <meta property="twitter:title" content="Express DB">
    <meta property="twitter:description" content="Guides and references for SQL Server Express">
    <meta property="twitter:image" content="/expressdb-og.png">
    
    <link rel="preload" href="/assets/css/0.styles.9f84806b.css" as="style"><link rel="preload" href="/assets/js/app.36ff7a56.js" as="script"><link rel="preload" href="/assets/js/2.197ad26e.js" as="script"><link rel="preload" href="/assets/js/1.8e43fea6.js" as="script"><link rel="preload" href="/assets/js/33.48a13f6a.js" as="script"><link rel="prefetch" href="/assets/js/10.3449f7a6.js"><link rel="prefetch" href="/assets/js/11.77424de7.js"><link rel="prefetch" href="/assets/js/12.4c348da1.js"><link rel="prefetch" href="/assets/js/13.fe4698a5.js"><link rel="prefetch" href="/assets/js/14.7f7d2e31.js"><link rel="prefetch" href="/assets/js/15.f80a4b1a.js"><link rel="prefetch" href="/assets/js/16.841ad4f3.js"><link rel="prefetch" href="/assets/js/17.a2a54ee1.js"><link rel="prefetch" href="/assets/js/18.414dc639.js"><link rel="prefetch" href="/assets/js/19.b2573b9e.js"><link rel="prefetch" href="/assets/js/20.ac7640fc.js"><link rel="prefetch" href="/assets/js/21.3fc53ab6.js"><link rel="prefetch" href="/assets/js/22.127a26b9.js"><link rel="prefetch" href="/assets/js/23.ce04f067.js"><link rel="prefetch" href="/assets/js/24.c4d079f7.js"><link rel="prefetch" href="/assets/js/25.fd78efb9.js"><link rel="prefetch" href="/assets/js/26.126ffd1b.js"><link rel="prefetch" href="/assets/js/27.71f2000a.js"><link rel="prefetch" href="/assets/js/28.fe6db42d.js"><link rel="prefetch" href="/assets/js/29.256e9c3d.js"><link rel="prefetch" href="/assets/js/3.db05072d.js"><link rel="prefetch" href="/assets/js/30.71177cee.js"><link rel="prefetch" href="/assets/js/31.60ed991e.js"><link rel="prefetch" href="/assets/js/32.e0b1b5a9.js"><link rel="prefetch" href="/assets/js/34.2e67f23b.js"><link rel="prefetch" href="/assets/js/35.045eed85.js"><link rel="prefetch" href="/assets/js/36.6d1721c3.js"><link rel="prefetch" href="/assets/js/37.c7663374.js"><link rel="prefetch" href="/assets/js/38.45f0a3e5.js"><link rel="prefetch" href="/assets/js/39.ddac4d34.js"><link rel="prefetch" href="/assets/js/4.a83cb2bb.js"><link rel="prefetch" href="/assets/js/40.f232c8c2.js"><link rel="prefetch" href="/assets/js/41.3b860a0e.js"><link rel="prefetch" href="/assets/js/5.3cd12f21.js"><link rel="prefetch" href="/assets/js/6.aa885f32.js"><link rel="prefetch" href="/assets/js/7.f4e62dee.js"><link rel="prefetch" href="/assets/js/vendors~docsearch.4dff5a50.js">
    <link rel="stylesheet" href="/assets/css/0.styles.9f84806b.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">Express DB</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">
  Home
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Guides Menu" class="dropdown-title"><span class="title">Guides</span> <span class="arrow down"></span></button> <button type="button" aria-label="Guides Menu" class="mobile-dropdown-title"><span class="title">Guides</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/what-is-sql-server-express.html" class="nav-link">
  What is SQL Server Express?
</a></li><li class="dropdown-item"><!----> <a href="/sql-server-express-feature-comparison.html" class="nav-link">
  Express vs. Standard vs. Enterprise
</a></li><li class="dropdown-item"><!----> <a href="/sql-server-express-vs-localdb.html" class="nav-link">
  SQL Express vs. LocalDB
</a></li><li class="dropdown-item"><!----> <a href="/which-sql-server-express-version-to-use.html" class="nav-link">
  Which Express Version to Use
</a></li><li class="dropdown-item"><!----> <a href="/which-sql-server-management-studio-version.html" class="nav-link">
  Which Management Studio to Use
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Limitations Menu" class="dropdown-title"><span class="title">Limitations</span> <span class="arrow down"></span></button> <button type="button" aria-label="Limitations Menu" class="mobile-dropdown-title"><span class="title">Limitations</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/sql-server-express-database-size-limit.html" class="nav-link">
  Size Restrictions
</a></li><li class="dropdown-item"><!----> <a href="/sql-server-express-hardware-limitations.html" class="nav-link">
  Hardware Restrictions
</a></li><li class="dropdown-item"><!----> <a href="/sql-server-express-sp-send-dbmail.html" class="nav-link">
  Missing Database Mail
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Best Practices Menu" class="dropdown-title"><span class="title">Best Practices</span> <span class="arrow down"></span></button> <button type="button" aria-label="Best Practices Menu" class="mobile-dropdown-title"><span class="title">Best Practices</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/sql-server-express-backups.html" class="nav-link">
  Backups
</a></li><li class="dropdown-item"><!----> <a href="/sql-server-express-maintenance.html" class="nav-link">
  Maintenance
</a></li><li class="dropdown-item"><!----> <a href="/sql-server-express-security-best-practices.html" class="nav-link">
  Security
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Automation Menu" class="dropdown-title"><span class="title">Automation</span> <span class="arrow down"></span></button> <button type="button" aria-label="Automation Menu" class="mobile-dropdown-title"><span class="title">Automation</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/sql-server-express-replace-sql-agent.html" aria-current="page" class="nav-link router-link-exact-active router-link-active">
  Replacing SQL Agent
</a></li><li class="dropdown-item"><!----> <a href="/sql-server-express-unattended-install.html" class="nav-link">
  Unattended Installation
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Free Tools Menu" class="dropdown-title"><span class="title">Tools &amp; Resources</span> <span class="arrow down"></span></button> <button type="button" aria-label="Free Tools Menu" class="mobile-dropdown-title"><span class="title">Tools &amp; Resources</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/sql-server-resources.html" class="nav-link">
  Scripts, Apps, and Resources
</a></li><li class="dropdown-item"><!----> <a href="https://dba-multitool.org" target="_blank" rel="noopener noreferrer" class="nav-link external">
  DBA MultiTool
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="/azure-data-studio.html" class="nav-link">
  Azure Data Studio
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Author Menu" class="dropdown-title"><span class="title">Author</span> <span class="arrow down"></span></button> <button type="button" aria-label="Author Menu" class="mobile-dropdown-title"><span class="title">Author</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/about.html" class="nav-link">
  About
</a></li><li class="dropdown-item"><!----> <a href="/contact.html" class="nav-link">
  Contact
</a></li></ul></div></div> <a href="https://github.com/LowlyDBA/expressdb" target="_blank" rel="noopener noreferrer" class="repo-link">
    Contribute!
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">
  Home
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Guides Menu" class="dropdown-title"><span class="title">Guides</span> <span class="arrow down"></span></button> <button type="button" aria-label="Guides Menu" class="mobile-dropdown-title"><span class="title">Guides</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/what-is-sql-server-express.html" class="nav-link">
  What is SQL Server Express?
</a></li><li class="dropdown-item"><!----> <a href="/sql-server-express-feature-comparison.html" class="nav-link">
  Express vs. Standard vs. Enterprise
</a></li><li class="dropdown-item"><!----> <a href="/sql-server-express-vs-localdb.html" class="nav-link">
  SQL Express vs. LocalDB
</a></li><li class="dropdown-item"><!----> <a href="/which-sql-server-express-version-to-use.html" class="nav-link">
  Which Express Version to Use
</a></li><li class="dropdown-item"><!----> <a href="/which-sql-server-management-studio-version.html" class="nav-link">
  Which Management Studio to Use
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Limitations Menu" class="dropdown-title"><span class="title">Limitations</span> <span class="arrow down"></span></button> <button type="button" aria-label="Limitations Menu" class="mobile-dropdown-title"><span class="title">Limitations</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/sql-server-express-database-size-limit.html" class="nav-link">
  Size Restrictions
</a></li><li class="dropdown-item"><!----> <a href="/sql-server-express-hardware-limitations.html" class="nav-link">
  Hardware Restrictions
</a></li><li class="dropdown-item"><!----> <a href="/sql-server-express-sp-send-dbmail.html" class="nav-link">
  Missing Database Mail
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Best Practices Menu" class="dropdown-title"><span class="title">Best Practices</span> <span class="arrow down"></span></button> <button type="button" aria-label="Best Practices Menu" class="mobile-dropdown-title"><span class="title">Best Practices</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/sql-server-express-backups.html" class="nav-link">
  Backups
</a></li><li class="dropdown-item"><!----> <a href="/sql-server-express-maintenance.html" class="nav-link">
  Maintenance
</a></li><li class="dropdown-item"><!----> <a href="/sql-server-express-security-best-practices.html" class="nav-link">
  Security
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Automation Menu" class="dropdown-title"><span class="title">Automation</span> <span class="arrow down"></span></button> <button type="button" aria-label="Automation Menu" class="mobile-dropdown-title"><span class="title">Automation</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/sql-server-express-replace-sql-agent.html" aria-current="page" class="nav-link router-link-exact-active router-link-active">
  Replacing SQL Agent
</a></li><li class="dropdown-item"><!----> <a href="/sql-server-express-unattended-install.html" class="nav-link">
  Unattended Installation
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Free Tools Menu" class="dropdown-title"><span class="title">Tools &amp; Resources</span> <span class="arrow down"></span></button> <button type="button" aria-label="Free Tools Menu" class="mobile-dropdown-title"><span class="title">Tools &amp; Resources</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/sql-server-resources.html" class="nav-link">
  Scripts, Apps, and Resources
</a></li><li class="dropdown-item"><!----> <a href="https://dba-multitool.org" target="_blank" rel="noopener noreferrer" class="nav-link external">
  DBA MultiTool
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="/azure-data-studio.html" class="nav-link">
  Azure Data Studio
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Author Menu" class="dropdown-title"><span class="title">Author</span> <span class="arrow down"></span></button> <button type="button" aria-label="Author Menu" class="mobile-dropdown-title"><span class="title">Author</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/about.html" class="nav-link">
  About
</a></li><li class="dropdown-item"><!----> <a href="/contact.html" class="nav-link">
  Contact
</a></li></ul></div></div> <a href="https://github.com/LowlyDBA/expressdb" target="_blank" rel="noopener noreferrer" class="repo-link">
    Contribute!
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>SQL Express = No Agent</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/sql-server-express-replace-sql-agent.html#sql-express-no-agent" class="sidebar-link">SQL Express = No Agent</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/sql-server-express-replace-sql-agent.html#windows" class="sidebar-link">Windows</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/sql-server-express-replace-sql-agent.html#windows-task-scheduler" class="sidebar-link">Windows Task Scheduler</a></li></ul></li><li><a href="/sql-server-express-replace-sql-agent.html#linux" class="sidebar-link">Linux</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/sql-server-express-replace-sql-agent.html#platform-agnostic" class="sidebar-link">Platform Agnostic</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/sql-server-express-replace-sql-agent.html#airflow" class="sidebar-link">Airflow</a></li></ul></li><li><a href="/sql-server-express-replace-sql-agent.html#further-reading" class="sidebar-link">Further Reading</a><ul class="sidebar-sub-headers"></ul></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h2 id="sql-express-no-agent"><a href="#sql-express-no-agent" class="header-anchor">#</a> SQL Express = No Agent</h2> <p>One of the biggest feature limitations of SQL Server Express is the exclusion of
the SQL Agent. Not only does SQL Agent work wonderfully for managing ETL, SSIS,
and maintenance jobs across one or more servers, but it also functions as a general
job scheduler. It can execute any PowerShell or command prompt script to take care of
any number of processes or jobs that may be 100% external to SQL Server.</p> <ul><li><a href="#windows">Windows</a></li> <li><a href="#linux">Linux</a></li> <li><a href="#platform-agnostic">Platform Agnostic</a></li></ul> <h2 id="windows"><a href="#windows" class="header-anchor">#</a> Windows</h2> <h3 id="windows-task-scheduler"><a href="#windows-task-scheduler" class="header-anchor">#</a> Windows Task Scheduler</h3> <p>Without a SQL Agent, the default option for <a href="/sql-server-express-backups.html">managing backups</a> and <a href="/sql-server-express-maintenance.html">maintenance scripts</a> on SQL Server Express is not an option. Luckily, one of the next best alternatives is free, included in Windows,
and takes very little time to configure. Enter Windows Task Scheduler!</p> <p>To utilize the task scheduler, a task must be created that will execute a batch script containing the code to run on the SQL Express Instance. In this example, it will be a maintenance job
that will be run weekly to ensure indexes are defragmented on user databases. The
settings for the maintenance job will be copied directly from Ola's scripts to replicate
the parameters that are used to create a job when the SQL Agent is available.</p> <ul><li><a href="#task-scheduler-gui">Creating a Task via GUI</a></li> <li><a href="#task-scheduler-command-line">Creating a Task via Command Line</a></li></ul> <h4 id="task-scheduler-gui"><a href="#task-scheduler-gui" class="header-anchor">#</a> Task Scheduler GUI</h4> <ol><li><p>Install <a href="https://ola.hallengren.com/sql-server-index-and-statistics-maintenance.html" target="_blank" rel="noopener noreferrer">Ola Hallengren's maintenance scripts<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> if they haven't been already. <em>There may be a message about SQLServerAgent not running when installing these scripts. That is expected since the agent isn't available, but will not affect the installation.</em></p></li> <li><p>Create a <code>.bat</code> file for the sqlcmd script that will run the maintenance stored procedure:</p> <div class="language-batch line-numbers-mode"><pre class="language-batch"><code><span class="token command"><span class="token keyword">sqlcmd</span> <span class="token parameter attr-name">-E</span> <span class="token parameter attr-name">-S</span> .\SQLEXPRESS <span class="token parameter attr-name">-d</span> master <span class="token operator">^</span>
<span class="token parameter attr-name">-Q</span> <span class="token string">&quot;EXECUTE [dbo].[IndexOptimize] @Databases = 'USER_DATABASES', @LogToTable = 'Y'&quot;</span> <span class="token parameter attr-name">-b</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div></li> <li><p>Search for &quot;Task Scheduler&quot; from the start menu to open the scheduler</p></li> <li><p>Right click &quot;Task Scheduler&quot; and select &quot;Create Basic Task&quot;</p> <p><img src="/task_scheduler_1.PNG" alt="Windows Task Scheduler"></p></li> <li><p>Input a name and description for the task.</p> <p><img src="/task_scheduler_2.PNG" alt="Windows Task Scheduler"></p></li> <li><p>Pick a weekly schedule or one that works based on the database's usage.</p> <p><img src="/task_scheduler_3.PNG" alt="Windows Task Scheduler"></p></li> <li><p>Choose &quot;Start a Program&quot; as the action type.</p></li> <li><p>Insert the <code>.bat</code> file created earlier.</p> <p><img src="/task_scheduler_4.PNG" alt="Windows Task Scheduler"></p></li> <li><p>Test run the job to ensure it is working as expected.</p></li></ol> <p>Repeat the above steps to handle database backups, DBCC checks, and other database maintenance as needed.</p> <h4 id="task-scheduler-command-line"><a href="#task-scheduler-command-line" class="header-anchor">#</a> Task Scheduler Command Line</h4> <p>Using Windows Task Scheduler from the command line involves running <a href="https://docs.microsoft.com/en-us/windows/win32/taskschd/schtasks" target="_blank" rel="noopener noreferrer">schtasks.exe<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> to schedule and configure tasks.</p> <ol><li><p>Install <a href="https://ola.hallengren.com/sql-server-index-and-statistics-maintenance.html" target="_blank" rel="noopener noreferrer">Ola Hallengren's maintenance scripts<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> if they haven't been already. <em>There may be a message about SQLServerAgent not running when installing these scripts. That is expected since the agent isn't available, but will not affect the installation.</em></p></li> <li><p>Create a <code>.bat</code> file for the sqlcmd script that will run the maintenance stored procedure:</p> <div class="language-batch line-numbers-mode"><pre class="language-batch"><code><span class="token command"><span class="token keyword">sqlcmd</span> <span class="token parameter attr-name">-E</span> <span class="token parameter attr-name">-S</span> .\SQLEXPRESS <span class="token parameter attr-name">-d</span> master <span class="token operator">^</span>
<span class="token parameter attr-name">-Q</span> <span class="token string">&quot;EXECUTE [dbo].[IndexOptimize] @Databases = 'USER_DATABASES', @LogToTable = 'Y'&quot;</span> <span class="token parameter attr-name">-b</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div></li> <li><p>Replace the placeholder values and run the script below to create a scheduled task:</p></li></ol> <ul><li><p><code>RU</code> - Windows user the task will run as.</p></li> <li><p><code>RP</code> - Password for the RU.</p></li> <li><p><code>SC</code> - Run schedule (MINUTE, HOURLY, DAILY, WEEKLY, MONTHLY, ONCE, ONLOGON, ONIDLE, or ONEVENT.)</p></li> <li><p><code>TN</code> - Task Name.</p></li> <li><p><code>TR</code> - A value that specifies the path and file name of the task to be run.</p></li> <li><p><code>MO</code> - Modifier to add more fine grained control over the schedule:</p> <ul><li>MINUTE: 1 - 1439 minutes.</li> <li>DAILY: 1 - 365 days.</li> <li>WEEKLY: weeks 1 - 52.</li> <li>MONTHLY: 1 - 12, or FIRST, SECOND, THIRD, FOURTH, LAST, and LASTDAY.</li> <li>ONEVENT: XPath event query string.</li></ul></li> <li><p><code>D</code> - A value that specifies the day of the week to run the task. Valid values are: MON, TUE, WED, THU, FRI, SAT, SUN and for MONTHLY schedules 1 - 31 (days of the month). The wildcard character ( * ) specifies all days.</p></li> <li><p><code>M</code> - A value that specifies months of the year. Defaults to the first day of the month. Valid values are: JAN, FEB, MAR, APR, MAY, JUN, JUL, AUG, SEP, OCT, NOV, and DEC. The wildcard character ( * ) specifies all months.</p> <div class="language-batch line-numbers-mode"><pre class="language-batch"><code><span class="token command"><span class="token keyword">schtasks</span>  <span class="token parameter attr-name">/Create</span> <span class="token parameter attr-name">/RU</span> MyLogin <span class="token parameter attr-name">/RP</span> MyPassword <span class="token parameter attr-name">/SC</span> WEEKLY [<span class="token parameter attr-name">/MO</span> modifier] [<span class="token parameter attr-name">/D</span> day] [<span class="token parameter attr-name">/M</span> months] <span class="token operator">^</span>
<span class="token parameter attr-name">/TN</span> SQLExpressMaintenance <span class="token parameter attr-name">/TR</span> C:\express_maintenance.bat</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div></li></ul> <p>Repeat the above steps to handle database backups, DBCC checks, and other database maintenance as needed.</p> <h2 id="linux"><a href="#linux" class="header-anchor">#</a> Linux</h2> <p>For installations of SQL Server Express on Linux, the built-in system chron scheduler can be used to run maintenance and other SQL Server tasks.</p> <ol><li><p>Install <a href="https://ola.hallengren.com/sql-server-index-and-statistics-maintenance.html" target="_blank" rel="noopener noreferrer">Ola Hallengren's maintenance scripts<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> if they haven't been already. <em>There may be a message about SQLServerAgent not running when installing these scripts. That is expected since the agent isn't available, but will not affect the installation.</em></p></li> <li><p>Create a bash script to execute the maintenance procedure (we'll call ours <code>sqlmaint.sh</code>):</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token shebang important">#!/bin/bash</span>
sqlcmd <span class="token parameter variable">-E</span> <span class="token parameter variable">-S</span> .<span class="token punctuation">\</span>SQLEXPRESS <span class="token parameter variable">-d</span> master <span class="token punctuation">\</span>
<span class="token parameter variable">-Q</span> <span class="token string">&quot;EXECUTE [dbo].[IndexOptimize] @Databases = 'USER_DATABASES', @LogToTable = 'Y'&quot;</span> <span class="token parameter variable">-b</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div></li> <li><p>Schedule the script to run via cron by opening the cron editor from the shell:</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token function">crontab</span> <span class="token parameter variable">-e</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div></li> <li><p>And adding the script on a schedule:</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>00 <span class="token number">23</span> * * * /bin/sqlmaint.sh <span class="token comment"># Run maintenance 11PM every day</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div></li></ol> <p>Repeat the above steps for any other tasks that need to be regularly scheduled.</p> <h2 id="platform-agnostic"><a href="#platform-agnostic" class="header-anchor">#</a> Platform Agnostic</h2> <h3 id="airflow"><a href="#airflow" class="header-anchor">#</a> Airflow</h3> <p>A relative newcomer, <a href="https://airflow.apache.org/" target="_blank" rel="noopener noreferrer">Airflow<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> is a &quot;platform created by community to programmatically author, schedule and monitor workflows.&quot; It is backed by Apache, built in Python, and 100 percent free. Airflow has been making huge waves in data engineering and data science areas due to its relative ease to manage and customizability.</p> <p>While it may be overkill to leverage Airflow <em>just</em> for simple backup or maintenance scripts, if you have needs for other scheduled workflows around SQL Server Express, it may be a good fit. Airflow will require some knowledge of Python to get everything operational, but out of the box Airflow does include a <a href="https://airflow.apache.org/docs/stable/_api/airflow/hooks/mssql_hook/index.html" target="_blank" rel="noopener noreferrer">basic hook for SQL Server<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> which should make a basic proof of concept an easy task to accomplish.</p> <h2 id="further-reading"><a href="#further-reading" class="header-anchor">#</a> Further Reading</h2> <ul><li><a href="https://ola.hallengren.com/frequently-asked-questions.html" target="_blank" rel="noopener noreferrer">FAQ on Ola Hallengren's Scripts<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li>Microsoft KB on <a href="https://support.microsoft.com/en-us/help/2019698/how-to-schedule-and-automate-backups-of-sql-server-databases-in-sql-se" target="_blank" rel="noopener noreferrer">How to Schedule and Automate Backups of SQL Server Databases in SQL Server Express<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li>Microsoft Documentation on <a href="https://docs.microsoft.com/en-us/sql/tools/sqlcmd-utility?view=sql-server-2017" target="_blank" rel="noopener noreferrer">sqlcmd<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul> <br> <br> <!----></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/LowlyDBA/expressdb.io/edit/master//sql-server-express-replace-sql-agent.md" target="_blank" rel="noopener noreferrer">Edit this page on Github</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div> <div class="last-updated"><span class="prefix">Last Updated:</span> <span class="time">12/19/2020, 6:04:33 PM</span></div></footer> <!----> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.36ff7a56.js" defer></script><script src="/assets/js/2.197ad26e.js" defer></script><script src="/assets/js/1.8e43fea6.js" defer></script><script src="/assets/js/33.48a13f6a.js" defer></script>
  </body>
</html>
